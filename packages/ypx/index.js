Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.YPX = YPX;
exports.default = void 0;

var _crossSpawnExtra = _interopRequireDefault(require("cross-spawn-extra"));

var _createTemporaryDirectory = _interopRequireDefault(require("./lib/createTemporaryDirectory"));

var _fsExtra = require("fs-extra");

var _findCommand = _interopRequireDefault(require("./lib/findCommand"));

var _initTemporaryPackage = _interopRequireDefault(require("./lib/initTemporaryPackage"));

var _handleOptions = _interopRequireDefault(require("./lib/handleOptions"));

var _handleEnv = _interopRequireDefault(require("./lib/handleEnv"));

var _installDependencies = _interopRequireDefault(require("./lib/installDependencies"));

var _util = require("util");

var _logger = _interopRequireDefault(require("./lib/logger"));

var _binExists = _interopRequireDefault(require("bin-exists"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

async function YPX(_argv, inputArgv) {
  var _argv$package, _argv$_$;

  let argv = _argv;

  if (!((_argv$package = argv.package) === null || _argv$package === void 0 ? void 0 : _argv$package.length)) {
    throw new Error(`package name is need`);
  }

  argv = await (0, _handleOptions.default)(argv);

  if (argv._.length > 1) {
    throw new Error(`command not invalid, ${argv._}`);
  }

  let runtime = {
    tmpDir: await (0, _createTemporaryDirectory.default)(),
    created: false,
    skipInstall: {},
    console: (0, _logger.default)(argv)
  };
  const consoleShow = (0, _logger.default)({ ...argv,
    quiet: false
  });
  const {
    console
  } = runtime;
  let label = 'ypx';
  console.time(label);
  console.time(`installed`);
  await (0, _initTemporaryPackage.default)(runtime.tmpDir).tapCatch(e => {
    console.error(`failed create temp package, ${runtime.tmpDir}`);
  });
  await (0, _installDependencies.default)(argv, runtime);

  if (Object.keys(runtime.skipInstall).length) {
    console.info(`skip install`, (0, _util.inspect)(runtime.skipInstall), `or maybe u wanna use --ignore-existing`);
  }

  console.timeEnd(`installed`);
  let command = (_argv$_$ = argv._[0]) !== null && _argv$_$ !== void 0 ? _argv$_$ : argv.package[argv.package.length - 1];
  let cmd_exists;

  if (!(command in runtime.skipInstall)) {
    await (0, _findCommand.default)(command, runtime.tmpDir).catch(err => null).then(bin => {
      if (bin) {
        command = bin;
        cmd_exists = true;
      } else {
        cmd_exists = false;
      }
    });
  }

  if (!cmd_exists) {
    await (0, _binExists.default)(command).catch(e => null).then(bool => {
      if (bool) {
        console.warn(`found command '${command}', but it maybe not a module bin`);
      } else {
        console.warn(`command not found: ${command}, maybe will not callable`);
      }
    });
  }

  let env = runtime.env = await (0, _handleEnv.default)(argv, runtime);
  console.time(`exec`);
  console.debug(`[CWD]`, argv.cwd);

  if (argv.userconfig) {
    console.debug(`[RC]`, argv.userconfig);
  }

  console.debug(`[EXEC]`, command, argv['--']);
  await (0, _crossSpawnExtra.default)(command, argv['--'], {
    stdio: 'inherit',
    env,
    cwd: argv.cwd
  }).catch(e => {
    if (e.code === 'ENOENT') {
      consoleShow.magenta.error(`command not found: ${command}`);
      console.timeEnd(`exec`);
      console.timeEnd(label);
      process.exit(1);
    }

    return Promise.reject(e);
  });
  console.timeEnd(`exec`);
  console.time(`remove temp package`);
  await (0, _fsExtra.remove)(runtime.tmpDir);
  console.timeEnd(`remove temp package`);
  console.timeEnd(label);
}

var _default = YPX;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIllQWCIsIl9hcmd2IiwiaW5wdXRBcmd2IiwiYXJndiIsInBhY2thZ2UiLCJsZW5ndGgiLCJFcnJvciIsIl8iLCJydW50aW1lIiwidG1wRGlyIiwiY3JlYXRlZCIsInNraXBJbnN0YWxsIiwiY29uc29sZSIsImNvbnNvbGVTaG93IiwicXVpZXQiLCJsYWJlbCIsInRpbWUiLCJ0YXBDYXRjaCIsImUiLCJlcnJvciIsIk9iamVjdCIsImtleXMiLCJpbmZvIiwidGltZUVuZCIsImNvbW1hbmQiLCJjbWRfZXhpc3RzIiwiY2F0Y2giLCJlcnIiLCJ0aGVuIiwiYmluIiwiYm9vbCIsIndhcm4iLCJlbnYiLCJkZWJ1ZyIsImN3ZCIsInVzZXJjb25maWciLCJzdGRpbyIsImNvZGUiLCJtYWdlbnRhIiwicHJvY2VzcyIsImV4aXQiLCJQcm9taXNlIiwicmVqZWN0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFJQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUdPLGVBQWVBLEdBQWYsQ0FBbUJDLEtBQW5CLEVBQThDQyxTQUE5QyxFQUNQO0FBQUE7O0FBQ0MsTUFBSUMsSUFBSSxHQUFHRixLQUFYOztBQUVBLE1BQUksbUJBQUNFLElBQUksQ0FBQ0MsT0FBTixrREFBQyxjQUFjQyxNQUFmLENBQUosRUFDQTtBQUNDLFVBQU0sSUFBSUMsS0FBSixDQUFXLHNCQUFYLENBQU47QUFDQTs7QUFFREgsRUFBQUEsSUFBSSxHQUFHLE1BQU0sNEJBQWNBLElBQWQsQ0FBYjs7QUFFQSxNQUFJQSxJQUFJLENBQUNJLENBQUwsQ0FBT0YsTUFBUCxHQUFnQixDQUFwQixFQUNBO0FBQ0MsVUFBTSxJQUFJQyxLQUFKLENBQVcsd0JBQXVCSCxJQUFJLENBQUNJLENBQUUsRUFBekMsQ0FBTjtBQUNBOztBQUVELE1BQUlDLE9BQXNCLEdBQUc7QUFDNUJDLElBQUFBLE1BQU0sRUFBRSxNQUFN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QUFpQ3JCLElBQUksQ0FBQyxJQUFELENBQXJDO0FBQ0EsUUFBTSw4QkFBZ0JxQixPQUFoQixFQUF5QnJCLElBQUksQ0FBQyxJQUFELENBQTdCLEVBQXFDO0FBQzFDaUMsSUFBQUEsS0FBSyxFQUFFLFNBRG1DO0FBRTFDSixJQUFBQSxHQUYwQztBQUcxQ0UsSUFBQUEsR0FBRyxFQUFFL0IsSUFBSSxDQUFDK0I7QUFIZ0MsR0FBckMsRUFLSlIsS0FMSSxDQUtFUixDQUFDLElBQUk7QUFFWCxRQUFJQSxDQUFDLENBQUNtQixJQUFGLEtBQVcsUUFBZixFQUNBO0FBQ0N4QixNQUFBQSxXQUFXLENBQUN5QixPQUFaLENBQW9CbkIsS0FBcEIsQ0FBMkIsc0JBQXFCSyxPQUFRLEVBQXhEO0FBRUFaLE1BQUFBLE9BQU8sQ0FBQ1csT0FBUixDQUFpQixNQUFqQjtBQUNBWCxNQUFBQSxPQUFPLENBQUNXLE9BQVIsQ0FBZ0JSLEtBQWhCO0FBQ0F3QixNQUFBQSxPQUFPLENBQUNDLElBQVIsQ0FBYSxDQUFiO0FBQ0E7O0FBRUQsV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWV4QixDQUFmLENBQVA7QUFDQSxHQWpCSSxDQUFOO0FBb0JBTixFQUFBQSxPQUFPLENBQUNXLE9BQVIsQ0FBaUIsTUFBakI7QUFFQVgsRUFBQUEsT0FBTyxDQUFDSSxJQUFSLENBQWMscUJBQWQ7QUFDQSxRQUFNLHFCQUFPUixPQUFPLENBQUNDLE1BQWYsQ0FBTjtBQUNBRyxFQUFBQSxPQUFPLENBQUNXLE9BQVIsQ0FBaUIscUJBQWpCO0FBRUFYLEVBQUFBLE9BQU8sQ0FBQ1csT0FBUixDQUFnQlIsS0FBaEI7QUFDQTs7ZUFFY2YsRyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDIwMjAvMS8yOC5cbiAqL1xuXG5pbXBvcnQgY3Jvc3NTcGF3bkV4dHJhIGZyb20gJ2Nyb3NzLXNwYXduLWV4dHJhJztcbmltcG9ydCBjcmVhdGVUZW1wb3JhcnlEaXJlY3RvcnkgZnJvbSAnLi9saWIvY3JlYXRlVGVtcG9yYXJ5RGlyZWN0b3J5JztcbmltcG9ydCB7IHJlbW92ZSB9IGZyb20gJ2ZzLWV4dHJhJztcbmltcG9ydCBmaW5kQ29tbWFuZCBmcm9tICcuL2xpYi9maW5kQ29tbWFuZCc7XG5pbXBvcnQgaW5pdFRlbXBvcmFyeVBhY2thZ2UgZnJvbSAnLi9saWIvaW5pdFRlbXBvcmFyeVBhY2thZ2UnO1xuaW1wb3J0IHsgSVlQWEFyZ3VtZW50c0lucHV0LCBJUnVudGltZUNhY2hlLCBJWVBYQXJndW1lbnRzIH0gZnJvbSAnLi9saWIvdHlwZXMnO1xuaW1wb3J0IGhhbmRsZU9wdGlvbnMgZnJvbSAnLi9saWIvaGFuZGxlT3B0aW9ucyc7XG5pbXBvcnQgaGFuZGxlRW52IGZyb20gJy4vbGliL2hhbmRsZUVudic7XG5pbXBvcnQgaW5zdGFsbERlcGVuZGVuY2llcyBmcm9tICcuL2xpYi9pbnN0YWxsRGVwZW5kZW5jaWVzJztcbmltcG9ydCB7IGluc3BlY3QgfSBmcm9tICd1dGlsJztcbmltcG9ydCBuZXdMb2dnZXIgZnJvbSAnLi9saWIvbG9nZ2VyJztcbmltcG9ydCBiaW5FeGlzdHMgZnJvbSAnYmluLWV4aXN0cyc7XG5pbXBvcnQgQmx1ZWJpcmQgZnJvbSAnYmx1ZWJpcmQnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gWVBYKF9hcmd2OiBJWVBYQXJndW1lbnRzSW5wdXQsIGlucHV0QXJndj86IHN0cmluZ1tdKVxue1xuXHRsZXQgYXJndiA9IF9hcmd2IGFzIFJlcXVpcmVkPElZUFhBcmd1bWVudHM+O1xuXG5cdGlmICghYXJndi5wYWNrYWdlPy5sZW5ndGgpXG5cdHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoYHBhY2thZ2UgbmFtZSBpcyBuZWVkYClcblx0fVxuXG5cdGFyZ3YgPSBhd2FpdCBoYW5kbGVPcHRpb25zKGFyZ3YpO1xuXG5cdGlmIChhcmd2Ll8ubGVuZ3RoID4gMSlcblx0e1xuXHRcdHRocm93IG5ldyBFcnJvcihgY29tbWFuZCBub3QgaW52YWxpZCwgJHthcmd2Ll99YClcblx0fVxuXG5cdGxldCBydW50aW1lOiBJUnVudGltZUNhY2hlID0ge1xuXHRcdHRtcERpcjogYXdhaXQgY3JlYXRlVGVtcG9yYXJ5RGlyZWN0b3J5KCksXG5cdFx0Y3JlYXRlZDogZmFsc2UsXG5cdFx0c2tpcEluc3RhbGw6IHt9LFxuXHRcdGNvbnNvbGU6IG5ld0xvZ2dlcihhcmd2KSxcblx0fTtcblxuXHRjb25zdCBjb25zb2xlU2hvdyA9IG5ld0xvZ2dlcih7XG5cdFx0Li4uYXJndixcblx0XHRxdWlldDogZmFsc2UsXG5cdH0pO1xuXG5cdGNvbnN0IHsgY29uc29sZSB9ID0gcnVudGltZTtcblxuXHRsZXQgbGFiZWwgPSAneXB4JztcblxuXHRjb25zb2xlLnRpbWUobGFiZWwpO1xuXHRjb25zb2xlLnRpbWUoYGluc3RhbGxlZGApO1xuXG5cdGF3YWl0IGluaXRUZW1wb3JhcnlQYWNrYWdlKHJ1bnRpbWUudG1wRGlyKVxuXHRcdC50YXBDYXRjaChlID0+XG5cdFx0e1xuXHRcdFx0Y29uc29sZS5lcnJvcihgZmFpbGVkIGNyZWF0ZSB0ZW1wIHBhY2thZ2UsICR7cnVudGltZS50bXBEaXJ9YClcblx0XHR9KVxuXHQ7XG5cblx0Ly9jb25zb2xlLmRpcihhcmd2KTtcblxuXHRhd2FpdCBpbnN0YWxsRGVwZW5kZW5jaWVzKGFyZ3YsIHJ1bnRpbWUpO1xuXG5cdGlmIChPYmplY3Qua2V5cyhydW50aW1lLnNraXBJbnN0YWxsKS5sZW5ndGgpXG5cdHtcblx0XHRjb25zb2xlLmluZm8oYHNraXAgaW5zdGFsbGAsIGluc3BlY3QocnVudGltZS5za2lwSW5zdGFsbCksIGBvciBtYXliZSB1IHdhbm5hIHVzZSAtLWlnbm9yZS1leGlzdGluZ2ApXG5cdH1cblxuXHRjb25zb2xlLnRpbWVFbmQoYGluc3RhbGxlZGApO1xuXG5cdGxldCBjb21tYW5kID0gYXJndi5fWzBdID8/IGFyZ3YucGFja2FnZVthcmd2LnBhY2thZ2UubGVuZ3RoIC0gMV07XG5cdGxldCBjbWRfZXhpc3RzOiBib29sZWFuO1xuXG5cdGlmICghKGNvbW1hbmQgaW4gcnVudGltZS5za2lwSW5zdGFsbCkpXG5cdHtcblx0XHRhd2FpdCBmaW5kQ29tbWFuZChjb21tYW5kLCBydW50aW1lLnRtcERpcilcblx0XHRcdC5jYXRjaChlcnIgPT4gbnVsbClcblx0XHRcdC50aGVuKGJpbiA9PlxuXHRcdFx0e1xuXHRcdFx0XHQvL2NvbnNvbGUuZGVidWcoY29tbWFuZCwgYD0+YCwgYmluKTtcblx0XHRcdFx0aWYgKGJpbilcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNvbW1hbmQgPSBiaW47XG5cdFx0XHRcdFx0Y21kX2V4aXN0cyA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y21kX2V4aXN0cyA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdDtcblx0fVxuXG5cdGlmICghY21kX2V4aXN0cylcblx0e1xuXHRcdGF3YWl0IGJpbkV4aXN0cyhjb21tYW5kKVxuXHRcdFx0LmNhdGNoKGUgPT4gbnVsbClcblx0XHRcdC50aGVuKGJvb2wgPT4ge1xuXG5cdFx0XHRcdGlmIChib29sKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKGBmb3VuZCBjb21tYW5kICcke2NvbW1hbmR9JywgYnV0IGl0IG1heWJlIG5vdCBhIG1vZHVsZSBiaW5gKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihgY29tbWFuZCBub3QgZm91bmQ6ICR7Y29tbWFuZH0sIG1heWJlIHdpbGwgbm90IGNhbGxhYmxlYClcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHQ7XG5cdH1cblxuXHRsZXQgZW52ID0gcnVudGltZS5lbnYgPSBhd2FpdCBoYW5kbGVFbnYoYXJndiwgcnVudGltZSk7XG5cblx0Y29uc29sZS50aW1lKGBleGVjYCk7XG5cblx0Y29uc29sZS5kZWJ1ZyhgW0NXRF1gLCBhcmd2LmN3ZCk7XG5cdGlmIChhcmd2LnVzZXJjb25maWcpXG5cdHtcblx0XHRjb25zb2xlLmRlYnVnKGBbUkNdYCwgYXJndi51c2VyY29uZmlnKTtcblx0fVxuXHRjb25zb2xlLmRlYnVnKGBbRVhFQ11gLCBjb21tYW5kLCBhcmd2WyctLSddKTtcblx0YXdhaXQgY3Jvc3NTcGF3bkV4dHJhKGNvbW1hbmQsIGFyZ3ZbJy0tJ10sIHtcblx0XHRzdGRpbzogJ2luaGVyaXQnLFxuXHRcdGVudixcblx0XHRjd2Q6IGFyZ3YuY3dkLFxuXHR9KVxuXHRcdC5jYXRjaChlID0+IHtcblxuXHRcdFx0aWYgKGUuY29kZSA9PT0gJ0VOT0VOVCcpXG5cdFx0XHR7XG5cdFx0XHRcdGNvbnNvbGVTaG93Lm1hZ2VudGEuZXJyb3IoYGNvbW1hbmQgbm90IGZvdW5kOiAke2NvbW1hbmR9YCk7XG5cdFx0XHRcdC8vY29uc29sZS5lcnJvcihlKTtcblx0XHRcdFx0Y29uc29sZS50aW1lRW5kKGBleGVjYCk7XG5cdFx0XHRcdGNvbnNvbGUudGltZUVuZChsYWJlbCk7XG5cdFx0XHRcdHByb2Nlc3MuZXhpdCgxKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuXHRcdH0pXG5cdDtcblxuXHRjb25zb2xlLnRpbWVFbmQoYGV4ZWNgKTtcblxuXHRjb25zb2xlLnRpbWUoYHJlbW92ZSB0ZW1wIHBhY2thZ2VgKTtcblx0YXdhaXQgcmVtb3ZlKHJ1bnRpbWUudG1wRGlyKTtcblx0Y29uc29sZS50aW1lRW5kKGByZW1vdmUgdGVtcCBwYWNrYWdlYCk7XG5cblx0Y29uc29sZS50aW1lRW5kKGxhYmVsKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgWVBYO1xuIl19
